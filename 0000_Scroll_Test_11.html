<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<!-- Always force latest IE rendering engine (even in intranet) & Chrome Frame
	Remove this if you use the .htaccess -->
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<title>RFTM | Content Slots Template</title>
	<meta name="description" content="">
	<meta name="author" content="Hugues Brunelle">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<script src="/reitmans_components/reitmans_sg2_richUI_default/lib/modernizr/modernizr.js"></script>
	<script src="/reitmans_components/reitmans_sg2_richUI_default/lib/jquery/jquery-1.7.1.min.js"></script>
	<script src="/reitmans_components/reitmans_sg2_richUI_default/lib/jquery/fancybox/jquery.fancybox.js"></script>
	<!-- <script src="/reitmans_components/reitmans_sg2_richUI_default/js/responsive.js"></script> -->
	<script src="/reitmans_components/reitmans_sg2_richUI_default/lib/jquery/jquery-ui-1.8.21.custom.min.js"></script>
	<!-- Replace favicon.ico & apple-touch-icon.png in the root of your domain and delete these references -->
	<link rel="shortcut icon" href="/favicon.ico">
	<link rel="apple-touch-icon" href="/apple-touch-icon.png">
	<link rel="stylesheet" href="/reitmans_components/reitmans_sg2_core_default/css/normalize.css" />
	<!--[if lt IE 9]>
	<![endif]-->
	<link href="/reitmans_components/reitmans_sg2_richUI_default/lib/fontello/css/fontello-embedded.css" rel="stylesheet" />
	<link rel="stylesheet" href="/reitmans_components/reitmans_sg2_richUI_default/lib/reitmans-ff/css/rff.css" />
	<link rel="stylesheet" href="/reitmans_components/reitmans_sg2_richUI_default/lib/reitmans-ff/style.min.css" />
	<link rel="stylesheet" href="/reitmans_components/brand_sg2_custom_default/css/custom.css" />
	<!-- bower:css -->
	<link rel="stylesheet" href="bower_components/owl.carousel/dist/assets/owl.carousel.css" />
	<!-- endbower -->
	<!-- rftm:css -->
	<link rel="stylesheet" href="/RW_CA/stylesheets/custom.css" />
	<!-- endrftm -->


<!-- Extra for scrollMagic-> -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/ScrollMagic/2.0.5/ScrollMagic.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/ScrollMagic/2.0.5/plugins/debug.addIndicators.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/1.20.4/TweenMax.min.js"></script>
<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/1.20.4/TweenLite.min.js"></script> -->
<script src="http://cdnjs.cloudflare.com/ajax/libs/ScrollMagic/2.0.5/plugins/animation.gsap.js"></script>
<!-- <-Extra for scrollMagic -->

</head>


<body>
	<div class="section pt_product-search-result main" style="padding: 0 20px;">
		<div class="wrapper container_24">
			<div id="main" role="main" class="clearfix">
				<div class="html-slot-container category-top-branding-slot">
					<!-- ################### -->
					<!-- Content slot markup -->
					<!-- ################### -->



<style>
html, body {
	height: 100%;
	min-height: 100%;
}
.otherElements {
	font-size: 4rem;
	margin: 0 auto;
	max-width: 960px;
	padding: 30px 0;
	width: 100%;
}
.container {
	margin: 0 auto 100px;
	/*position: initial;*/
	position: relative;
	left: 0;
	top: 0;
	width: 100%;
}
.panel {
	border-bottom: 6px solid #000;
	height: 100%;
	left: 0;
	overflow: hidden;
	position: absolute;
	top: 0;
	width: 100%;
}

.panel__01 {
	background: url('RW_CA/2018/spring/Test_Images/polo-01.jpg') no-repeat top center;
	background-size: cover;
	height: 100%;
	z-index: 20;
}
.panel__02 {
	background: url('RW_CA/2018/spring/Test_Images/polo-02.jpg') no-repeat top center;
	background-size: cover;
	height: 100%;
	z-index: 10;
}
.overlay {
	border: 100px solid yellow;
	background: #000;
	font-size: 9rem;
	height: 3000px;
	left: 0;
	opacity: .15;
	position: absolute;
	top: 0;
	width: 100%;
	/*z-index: -100;*/
}
</style>

<article class="use-fluid-grid">

	<div class="otherElements">
		Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum. Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
	</div>

	<div id="container" class="container">
		<div id="img02Cont" class="panel panel--02">
			<div id="img02" class="panel__02"></div>
		</div>
		<div id="img01Cont" class="panel panel--01">
			<div id="img01" class="panel__01"></div>
		</div>
	</div>

	<div id="overlay" class="overlay" style="display: none;">it amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum. Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderi</div>

	<div class="otherElements">
		Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum. Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
	</div>

</article>

<script>

var img01 = document.getElementById('img01'),
	container = document.getElementById('container'),
	img01Cont = document.getElementById('img01Cont'),
	overlay = document.getElementById('overlay'),
	innerH,
	rect,
	startingY = 0,
	endingY = 0,
	scAmount,
	scrollDir,
	CSSprop,
	newCSSprop,
	kickin = false,
	pinMode = false,
	isPassed;

var supportOffset = window.pageYOffset !== undefined,
	lastKnownPos = 0,
	ticking = false,
	scrollDir,
	currYPos;

var set2 = false,
	is01done = false,
	reverse = false;

var newStartingY;
var newCSSprop2;

$(window).on("load resize", function() {
	setHeight();

	rect = container.getBoundingClientRect();

	evalIfpassed();
	console.log('is passed on load? ' + isPassed);

	init();
});

$(window).on('scroll', function() {
	// lastKnownPos = 0;
});

function setHeight() {
	innerH = window.innerHeight;
	img01.style.height = innerH + 'px';
	img01Cont.style.height = innerH + 'px';
	container.style.height = innerH + 'px';
}

function evalIfpassed() {
	isPassed = rect.y < 0 ? true : false;
}

function init() {

	console.log('default height1 ' + window.getComputedStyle(img01Cont).getPropertyValue('height'));
	console.log('default height2 ' + img01Cont.style.height);

	

	function doSomething(scrollPos, scrollDir) {
		rect = container.getBoundingClientRect();
		console.log('SCR POS: ' + scrollPos);
		if (isPassed) {
			evalIfpassed();
		}

		if (is01done && rect.y >= 0) {
			reverse = true;
		}

		if (!isPassed && rect.y <= 0) {
			console.log('PIN Mode:' + pinMode);
			console.log('RECT y: ' + rect.y);

			// if (!pinMode && is01done) {
			// 	is01done = false;
			// 	// alert('yo');
			// }

			if (is01done == false) {
				overlay.style.display = 'block';
				container.style.position = 'fixed';
			}
			if (pinMode == false) {
				startingY = window.scrollY;
				console.log('startingY: ' + startingY);
				pinMode = true;
			}
			console.log('scrollDIR: ' + scrollDir);

			console.log('scAmount init: ' + scAmount);
			var sum = window.scrollY - parseInt(startingY);
			console.log('sum: ' + sum);
			scAmount = sum/10; //make animation 10 times milder
			// scAmount = sum;
			console.log('scAmount: ' + scAmount);
			if (scrollDir == 'down') {

				kickin = true;
				newCSSprop = 100 - scAmount;
				console.log('NEWTRAL newCSSprop: ' + newCSSprop);
				// endingY = scAmount;
				console.log('scroll UP1 ' + scrollDir);
			}
		}
		if (!isPassed && rect.y > -10) {
		// if (!isPassed && scrollPos < 944) { //temporary set 944
			if (scrollDir == 'up') {
				console.log('up start');

				scAmount = window.scrollY;
				// alert('up start');
				console.log('R_ect ' + rect.y);
				console.log('REVERSE ' + reverse);
				// var set2 = false;
				// if (!pinMode == false) {
				
				console.log('set2? : ' + set2);
				if (set2 == false) {
					newStartingY = window.scrollY;
					
					console.log('pinmode was false');
					console.log('newStartingY 1 : ' + newStartingY);
					pinMode = true;
					set2 = true;

					overlay.style.display = 'block';
					container.style.position = 'fixed';
					// scAmount = 0;
				}
				console.log('newStartingY 2 : ' + newStartingY);
				if (reverse) {
					// is01done = false;
					// pinMode = true;
				}
				console.log('newStartingY 3 : ' + newStartingY);
				kickin = false;
				console.log('SCAMOUNT LAST: ' + scAmount);
				console.log('newStartingY LAST: ' + newStartingY);
				// scAmount = parseInt(scAmount) - parseInt(endingY);
				scAmount = parseInt(newStartingY) - parseInt(scAmount);
				console.log('RESULT: ' + scAmount);
				console.log('CSSPROP: ' + newCSSprop);
				newCSSprop = scAmount; //10 times milder	
				console.log('UP newCSSprop: ' + newCSSprop);


				//duplicated
				img01Cont.style.height = parseInt(newCSSprop) + '%';
				console.log('img01Cont.style.height: ' + img01Cont.style.height);
				console.log('innerH: ' + innerH);
			}
		}
			console.log('newCSSprop: ' + newCSSprop);

			if (!is01done) {
				console.log('Window.scrollY: ' + window.scrollY);
				
				// newCSSprop = parseInt(newCSSprop)/2;
				img01Cont.style.height = parseInt(newCSSprop) + '%';
				console.log('img01Cont.style.height: ' + img01Cont.style.height);
				console.log('innerH: ' + innerH);
				//container.style.top = scAmount + 'px'; //keep container in viewport without using position fixed


			}


			if (pinMode && (scAmount >= 100 || scAmount <= -5)) {
				console.log('end of animation');

				// if (scrollDir == 'down') {
					overlay.style.display = 'none';
					container.style.position = 'relative';
				// }

				//only if sliding out downwards
				if (scAmount >= 100) {
					is01done = true;
					console.log('IS01done: ' + is01done);
					//container.style.top = '100px'; //kill the offset for the case of sliding out downwards
				}

				if (is01done && pinMode && kickin) {
					img01Cont.style.height = '0%';
				}

				pinMode = false;
				console.log('PIN MODE 2: ' + pinMode);
			}
		// }
	}

	window.addEventListener('wheel', function(e) {
		currYPos = supportOffset ? window.pageYOffset : document.body.scrollTop;
		scrollDir = lastKnownPos > currYPos ? 'up' : 'down';
		lastKnownPos = currYPos;

		if (!ticking) {
			window.requestAnimationFrame(function() {
				doSomething(lastKnownPos, scrollDir);
				ticking = false;
			});
		}
		ticking = true;
	});
}

</script>







					<!-- #################### -->
					<!--/ Content slot markup -->
					<!-- #################### -->
				</div>
			</div>
		</div>
	</div>
	<!-- bower:js -->
	<script src="bower_components/jquery/dist/jquery.js"></script>
	<script src="bower_components/jquery-sticky/jquery.sticky.js"></script>
	<script src="bower_components/skrollr/src/skrollr.js"></script>
	<script src="bower_components/scrollreveal/dist/scrollReveal.js"></script>
	<script src="bower_components/owl.carousel/dist/owl.carousel.js"></script>
	<!-- endbower -->
	<!-- rftm:js -->
	<script src="/RW_CA/vendor/flexslider/jquery.flexslider-min.js"></script>
	<!-- <script src="/RW_CA/vendor/enquire/enquire.min.js"></script> -->
	<script src="/RW_CA/javascripts/custom.js"></script>
	<!-- endrftm -->

</body>

</html>